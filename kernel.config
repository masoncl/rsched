# rsched minimal kernel config fragment
#
# Applied on top of defconfig. Options already in x86_64 defconfig
# (PERF_EVENTS, SCHEDSTATS, CGROUPS, KPROBES, etc.) are included
# for documentation â€” they're no-ops when already set.

# --- BPF core ---
# bpf() syscall: all program loading, map operations, tracepoint attachment
CONFIG_BPF_SYSCALL=y
# JIT compiler: translates BPF bytecode to native instructions
CONFIG_BPF_JIT=y

# --- BTF (CO-RE + tp_btf) ---
# Debug info: required for pahole to generate BTF from DWARF
# CONFIG_DEBUG_INFO_NONE is not set
CONFIG_DEBUG_INFO_DWARF_TOOLCHAIN_DEFAULT=y
# BTF type information: enables CO-RE relocations (field offset fixups
# across kernel versions) and tp_btf tracepoint attachment
CONFIG_DEBUG_INFO_BTF=y

# --- Perf events ---
# perf_event_open() syscall for hardware counters (cycles, instructions)
# bpf_perf_event_read_value() helper for reading counters from BPF
# Used by: -g perf (IPC, cache misses, generic PMU events)
CONFIG_PERF_EVENTS=y

# --- Schedstats ---
# /proc/schedstat: per-CPU and per-domain load balancing statistics
# /proc/sys/kernel/sched_schedstats: runtime enable knob
# Used by: -g schedstat
CONFIG_SCHEDSTATS=y

# --- Cgroups ---
# cgroup v2 support for --cgroup filter
# Enables bpf_get_current_cgroup_id() and task->cgroups->dfl_cgrp->kn->id
CONFIG_CGROUPS=y
